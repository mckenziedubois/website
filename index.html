<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta name="description" content="" />
    <meta name="author" content="" />
    <title>McKenzie DuBois</title>
    <!-- Font Awesome icons -->
    <script src="https://use.fontawesome.com/releases/v6.3.0/js/all.js" crossorigin="anonymous"></script>
    <!-- Google fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet" />
    <!-- Core theme CSS (Bootstrap + Clean Blog) -->
    <link href="css/styles.css" rel="stylesheet" />
    <!-- Custom overrides -->
    <link href="css/custom.css" rel="stylesheet" />
    <meta name="p:domain_verify" content="1424a6cbf48819328b2819252f3422ce"/>
    <!-- Google AdSense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5519492675847999"crossorigin="anonymous"></script>
</head>

<body>

  <!-- Navbar -->
  <div id="navbar-placeholder"></div>

  <!-- Masthead -->
  <header class="masthead" style="background-image: url('https://res.cloudinary.com/dsxlralvu/image/upload/v1761168364/header.jpg')">
    <div class="container position-relative px-4 px-lg-5">
      <div class="row gx-4 gx-lg-5 justify-content-center">
        <div class="col-md-10 col-lg-8 col-xl-7">
        </div>
      </div>
    </div>
  </header>
  
  <!-- Intro / About section (editable) -->
  <main class="container px-4 px-lg-5 my-5 text-center">
    <h2 class="mb-4">Welcome</h2>
    <p class="lead mb-4">Thanks for visiting my site. I have spent the last year traveling the world and wanted to create a site to document the places I've visted and share some of my photography. </p>
  </main>

  <!-- Recent Posts -->
  <section class="container px-4 px-lg-5 mb-5">
    <div class="row gx-2 gx-lg-3" id="recent-posts">
    </div>
  </section>

  <!-- Footer -->
  <footer class="border-top text-center py-4">
    <div class="small text-muted fst-italic">Copyright &copy; McKenzie DuBois 2025</div>
  </footer>

  <!-- Bootstrap core JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>

  <!-- Navbar fetch -->
  <script>
    const pathParts = window.location.pathname.split('/');
    const rootPrefix = '';

    fetch(`${rootPrefix}partials/nav.html`)
      .then(res => res.text())
      .then(html => {
        const htmlWithRoot = html.replace(/{ROOT}/g, rootPrefix);
        document.getElementById('navbar-placeholder').innerHTML = htmlWithRoot;

        // Highlight current link
        const currentPage = pathParts.pop() || 'index.html';
        document.querySelectorAll('#navbar-placeholder .nav-link').forEach(link => {
          const linkPage = link.getAttribute('href').split('/').pop();
          if (linkPage === currentPage) link.classList.add('active');
        });
      })
      .catch(err => console.error('Navbar fetch error:', err));
  </script>

  <!-- Fetch latest posts (3 desktop, 2 mobile) -->
  <script>
    // Helper to load CSV (simple parser matching other pages)
    async function loadCSV(url) {
      const text = await fetch(url).then(r => r.text());
      const [headerLine, ...lines] = text.trim().split("\n");
      const headers = headerLine.split(",").map(h => h.trim());
      return lines.map(line => {
        const cols = line.split(",");
        return Object.fromEntries(headers.map((h, i) => [h, cols[i]?.trim()]));
      });
    }

    (async function() {
      try {
        const posts = await fetch('posts/posts.json').then(r => r.json());
        const metadata = await loadCSV('pages/image_metadata.csv');

        const publishedPosts = posts.filter(post => post.active);
        publishedPosts.sort((a, b) => new Date(b.date) - new Date(a.date));

        // Get top 3 posts for recent section
        const allPosts = publishedPosts.slice(0, 3);

        const container = document.getElementById('recent-posts');
        container.innerHTML = allPosts.map((post, index) => {
          // Prefer CSV header image for this post (if provided)
          const headerRec = metadata.find(m => m.slug === post.slug && m.header && String(m.header).toLowerCase().trim() === 'true');
          const imageSrc = headerRec && headerRec.url ? headerRec.url.replace(/^http:\/\//i, 'https://') : (post.image ? post.image.replace(/^http:\/\//i, 'https://') : '');

          // Hide 3rd post on mobile (index 2)
          const hideOnMobile = index === 2 ? 'hide-on-mobile' : '';
          return `
          <div class="col-6 col-md-6 col-lg-4 mb-4 ${hideOnMobile}">
            <article class="card-magazine">
              <a class="card-media" href="posts/post.html?slug=${post.slug}">
                <img src="${imageSrc}" alt="${post.title}" loading="lazy" />
              </a>
              <div class="card-body">
                <a href="posts/post.html?slug=${post.slug}" class="card-title">${post.title}</a>
                <p class="card-excerpt">${post.subtitle || ''}</p>
                <div class="card-meta">Posted on ${new Date(post.date).toLocaleDateString('en-US', { month:'long', day:'numeric', year:'numeric' })}</div>
              </div>
            </article>
          </div>
        `;
        }).join('');
      } catch (err) {
        console.error('Posts or metadata fetch error:', err);
      }
    })();
  </script>

</body>
</html>
